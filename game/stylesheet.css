@font-face {
    font-family: 'MS Gothic';
    src: local('MS Gothic'), sans-serif;
}

/* vars */
:root {
    --text: white;
    --border: red;
    --accent: red;
    --panel-bg: rgba(0,0,0,0.5);
    --history-bg: rgba(0,0,0,0.9);

    --gap: 5px; /* Scaled from 0.75vw (~14px at 1920px) */
    --padding: 10px; /* Scaled from 1.5vw (~28px at 1920px) */
    --border-width: 1px;
    --letter-spacing: 1px; /* Scaled from 0.15vw (~2.8px at 1920px) */
    --font-size: 16px; /* Slightly reduced from 18px for better fit */
}

.wide {
    --gap: 8px; /* Slightly larger for wider screens */
    --padding: 12px;
    --border-width: 1px;
    --letter-spacing: 1.2px;
    --font-size: 16px;
}

/* loading */
#loadingscreen {
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    background: #000;
    z-index: 9999;
    color: #fff;
    text-align: center;
    font-size: 16px;
    padding-top: 20vh;
}

.toload {
    color: gray;
}

/* sizing + containers */
* {
    box-sizing: border-box;
    user-select: none;
    font-family: 'MS Gothic', sans-serif;
    font-size: var(--font-size);
}

body {
    margin: 0;
    background-color: black;
}

#container {
    width: 680px;
    height: 500px;
    font-size: var(--font-size);
    letter-spacing: var(--letter-spacing);
    margin: auto;
}

#container.standard {
    background-image: url("images/pattern43.jpg");
    background-repeat: repeat;
}

#container.fullBG {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
}

/* main row */
#main {
    display: flex;
    flex-direction: row-reverse; /* Reverse order: sidebar first (left), bg1 second (right) */
    height: 300px; /* 60% of 500px */
}

#bg1 {
    position: relative;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
    border: var(--border-width) solid var(--border);
    margin: var(--gap);
    margin-left: 0; /* Remove left margin to align with right edge */
    text-align: left; /* Changed from right to left for consistency */
    width: 476px; /* 70% of 680px */
    z-index: 1;
}

#fg1 {
    z-index: 2;
    height: 100%;
    background-color: transparent;
    border: none;
    -webkit-filter: drop-shadow(2px 2px 2px #FAF9F6);
    filter: drop-shadow(2px 2px 2px #FAF9F6);
}

.hidden {
    display: none;
}

#sidebar {
    width: 204px; /* 30% of 680px */
    margin: var(--gap);
    margin-right: 0; /* Remove right margin to align with left edge */
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
}

#choicewindow, #statuswindow {
    color: var(--text);
    margin-bottom: var(--gap);
    padding: var(--padding);
    border: var(--border-width) solid var(--border);
    background-color: var(--panel-bg);
    width: 100%; /* Full sidebar width */
    height: fit-content;
}

#choicelist {
    margin: 0;
}

.choiceListItem {
    color: var(--text);
    text-decoration: none;
}

.choiceListItem:hover {
    color: var(--accent);
    cursor: pointer;
}

/* dialogue row */
#dial {
    height: 175px; /* 35% of 500px */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    border: var(--border-width) solid var(--border);
    margin: 0 var(--gap);
    padding: var(--padding);
    background-color: var(--panel-bg);
}

#dial.transparent {
    background-color: transparent;
    border: none;
}

.dialog {
    height: auto;
    width: 100%;
    display: flex;
    flex-direction: row;
    align-content: stretch;
}

.dialogue-text {
    display: inline-block;
    color: #F1F1F1;
    text-align: left;
    overflow-wrap: break-word;
    max-width: 92%;
}

.dialogue-speaker {
    display: inline-block;
    min-width: 8%;
}

/* menu */
#menus {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 9;
}

.open-menu {
    color: var(--accent) !important;
}

#messagecontainer {
    color: var(--text);
    border: var(--border-width) solid var(--border);
    background-color: var(--history-bg);
    overflow-y: scroll;
    padding: var(--padding);
    text-align: left;
    position: absolute;
    width: 544px; /* 80% of 680px */
    height: 400px; /* 80% of 500px */
}

#messagecontainer::-webkit-scrollbar {
    display: none;
}

#messagelog {
    align-self: flex-start;
    list-style-type: none;
    padding-left: 0;
}

#settings-menu {
    position: fixed;
    pointer-events: all;
    width: 136px; /* 20% of 680px */
    height: auto;
    font-size: var(--font-size);
    z-index: 100;
    border: var(--border-width) solid var(--border);
    background-color: var(--panel-bg);
    color: #fff;
    padding: var(--padding);
}

#settings-menu > input {
    width: 100%;
}

#save-menu {
    position: fixed;
    pointer-events: all;
    width: 136px; /* 20% of 680px */
    height: auto;
    font-size: var(--font-size);
    z-index: 100;
    border: var(--border-width) solid var(--border);
    background-color: var(--panel-bg);
    color: #fff;
    padding: var(--padding);
}

#save-menu > div:hover {
    color: var(--accent);
    cursor: pointer;
}

#menu-buttons {
    height: 25px; /* 5% of 500px */
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    margin: 0 var(--gap);
    align-items: center;
}

#menu-buttons > div {
    margin-right: var(--gap);
    color: var(--text);
}

#menu-buttons > div:hover {
    color: var(--accent);
    cursor: pointer;
}

#menu-buttons > div:nth-last-child(2) {
    margin-left: auto;
}

/* crt tools */
@keyframes flicker {
    0% { opacity: 0.27861; }
    5% { opacity: 0.34769; }
    10% { opacity: 0.23604; }
    15% { opacity: 0.90626; }
    20% { opacity: 0.18128; }
    25% { opacity: 0.83891; }
    30% { opacity: 0.65583; }
    35% { opacity: 0.67807; }
    40% { opacity: 0.26559; }
    45% { opacity: 0.84693; }
    50% { opacity: 0.96019; }
    55% { opacity: 0.08594; }
    60% { opacity: 0.20313; }
    65% { opacity: 0.71988; }
    70% { opacity: 0.53455; }
    75% { opacity: 0.37288; }
    80% { opacity: 0.71428; }
    85% { opacity: 0.70419; }
    90% { opacity: 0.7003; }
    95% { opacity: 0.36108; }
    100% { opacity: 0.24387; }
}

@keyframes textShadow {
    0% { text-shadow: 0.4389924193300864px 0 1px rgba(0, 30, 255, 0.5), -0.4389924193300864px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    5% { text-shadow: 2.7928974010788217px 0 1px rgba(0, 30, 255, 0.5), -2.7928974010788217px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    10% { text-shadow: 0.02956275843481219px 0 1px rgba(0, 30, 255, 0.5), -0.02956275843481219px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    15% { text-shadow: 0.40218538552878136px 0 1px rgba(0, 30, 255, 0.5), -0.40218538552878136px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    20% { text-shadow: 3.4794037899852017px 0 1px rgba(0, 30, 255, 0.5), -1.4794037899852017px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    25% { text-shadow: 1.6125630401149584px 0 1px rgba(0, 30, 255, 0.5), -1.6125630401149584px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    30% { text-shadow: 0.7015590085143956px 0 1px rgba(0, 30, 255, 0.5), -0.7015590085143956px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    35% { text-shadow: 3.896914047650351px 0 1px rgba(0, 30, 255, 0.5), -2.896914047650351px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    40% { text-shadow: 3.870905614848819px 0 1px rgba(0, 30, 255, 0.5), -2.870905614848819px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    45% { text-shadow: 2.231056963361899px 0 1px rgba(0, 30, 255, 0.5), -2.231056963361899px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    50% { text-shadow: 0.08084290417898504px 0 1px rgba(0, 30, 255, 0.5), -0.08084290417898504px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    55% { text-shadow: 2.3758461067427543px 0 1px rgba(0, 30, 255, 0.5), -2.3758461067427543px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    60% { text-shadow: 2.202193051050636px 0 1px rgba(0, 30, 255, 0.5), -2.202193051050636px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    65% { text-shadow: 2.8638780614874975px 0 1px rgba(0, 30, 255, 0.5), -2.8638780614874975px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    70% { text-shadow: 0.48874025155497314px 0 1px rgba(0, 30, 255, 0.5), -0.48874025155497314px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    75% { text-shadow: 1.8948491305757957px 0 1px rgba(0, 30, 255, 0.5), -1.8948491305757957px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    80% { text-shadow: 0.0833037308038857px 0 1px rgba(0, 30, 255, 0.5), -0.0833037308038857px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    85% { text-shadow: 0.09769827255241735px 0 1px rgba(0, 30, 255, 0.5), -0.09769827255241735px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    90% { text-shadow: 3.443339761481782px 0 1px rgba(0, 30, 255, 0.5), -3.443339761481782px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    95% { text-shadow: 2.1841838852799786px 0 1px rgba(0, 30, 255, 0.5), -2.1841838852799786px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
    100% { text-shadow: 2.6208764473832513px 0 1px rgba(0, 30, 255, 0.5), -2.6208764473832513px 0 1px rgba(255, 0, 80, 0.3), 0 0 3px; }
}

.crt::after {
    content: " ";
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: rgba(18, 16, 16, 0.1);
    opacity: 0;
    z-index: 2;
    pointer-events: none;
}

.crt::before {
    content: " ";
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    z-index: 2;
    background-size: 100% 2px, 3px 100%;
    pointer-events: none;
}

.crt {
    animation: textShadow 5.6s infinite;
}